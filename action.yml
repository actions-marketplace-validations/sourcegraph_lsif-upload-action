name: Sourcegraph LSIF Uploader
description: Upload LSIF data to a Sourcegraph instance
author: Sourcegraph
branding:
  icon: upload
  color: purple

inputs:
  file:
    description: The LSIF dump file to upload
    default: data.lsif
  endpoint:
    description: The URL of the Sourcegraph instance
    default: https://sourcegraph.com
  access_token:
    description: The access token to use to authenticate to the Sourcegraph instance
    default: ''
  upload_token:
    description: The LSIF upload token generated for this repository (only necessary if lsifEnforceAuth setting is enabled`)
    default: ''

runs:
  using: docker
  image: Dockerfile
  env:
    SRC_ENDPOINT: ${{ inputs.endpoint }}
    SRC_ACCESS_TOKEN: ${{ inputs.access_token }}
    SRC_LSIF_UPLOAD_TOKEN: ${{ inputs.upload_token }}
  args:
    - ${{ inputs.file }}
